jQuery(document).ready(function(){
	if (Modernizr.svg) {
		jQuery('#branding img').attr('src','https://ohioduieval.com/sites/ohioduieval.com/themes/custom/ohio_dui/ohio_dui_core/logo.svg');
	}
	setTopBar();
});

/////////////////////
//    TEMPORARY    // 
/////////////////////

// SCROLL FUNCTIONS
jQuery(window).scroll(function(e){
	setTopBar();
});
function setTopBar(){
	var viewportWidth = jQuery(window).width();
	var scrolled = jQuery(window).scrollTop();
	if (viewportWidth > 1023) {
		if (scrolled < 20) { largeNav(); }
		else { smallNav(); }
	}
	if (viewportWidth > 1024) {
		jQuery("#home-bg-image").css('top',-(scrolled*0.2)+'px');
	}
}
function smallNav(){
	if (jQuery("#login a").css("top") == "-25px") {
		jQuery("#login a").css({
			"top": "-1px",
			"height": "22px",
			"line-height": "22px"
		});
	}
	jQuery("#top-nav").css({
		'height': '75px',
    'padding-bottom': '11px'
	});
	jQuery("#branding-wrapper").css({
		'margin-top': '0px'
	});
	jQuery("#branding").css({
		'width': '280px',
		'margin-top': '13px'
	});
	jQuery("#navbar").css({
		'margin-top': '30px'
	});
}
function largeNav(){
	jQuery("#login a").css({
		"top": "-25px",
		"height": "32px",
		"line-height": "32px"
	});
	jQuery("#top-nav").css({
		'height': '130px',
	    'padding-bottom': '0'
	});
	jQuery("#branding-wrapper").css({
		'margin-top': '27px'
	});
	jQuery("#branding").css({
		'width': '335px',
		'margin-top': '0px'
	});
	jQuery("#navbar").css({
		'margin-top': '24px'
	});
}
// Responsive NAV
jQuery(document).ready(function(){
	var responsiveButton = jQuery("<button></button>").append("+ NAV").addClass("responsive-nav-button");
	jQuery("#branding-wrapper").append(responsiveButton);
	jQuery(".responsive-nav-button").click(function(){
		if (jQuery(".responsive-nav-button").html() == "+ NAV") {
			jQuery("#navbar").css("right", "0px");
			jQuery(".responsive-nav-button").html("x NAV");
		} else {
			jQuery("#navbar").css("right", "-200px");
			jQuery(".responsive-nav-button").html("+ NAV");
		}
		jQuery(".responsive-nav-button").toggleClass("red-responsive");
	});
	jQuery(window).resize(function(){
		setResize();
	});
	setResize();
});
function setResize(){
	var windowHeight = screen.height;;
	var windowWidth = jQuery(window).width();
	if (windowWidth < 1024) {
		if (jQuery("#login a").css("top") == "-1px") {
			jQuery("#login a").css({
				"top": "-25px",
				"height": "32px",
				"line-height": "32px"
			});
			jQuery("#top-nav").css({
				'height': '130px',
			    'padding-bottom': '0'
			});
			jQuery("#branding-wrapper").css({
				'margin-top': '27px'
			});
			jQuery("#branding").css({
				'width': '335px',
				'margin-top': '0px'
			});
		}
		jQuery("#navbar").css("min-height", windowHeight);
	} else {
		jQuery("#navbar").css("min-height", "0px");
	}
}

// HOME FUNCTIONS
var animated = 0;
jQuery(window).scroll(function(e){
	var windowWidth = jQuery(window).width();
	if (jQuery("#home-process-wrap").length > 0 && windowWidth > 1024) {
		if (checkvisible("#home-process-wrap") && animated == 0) {
			setTimeout(function(){
				jQuery.each(jQuery(".home-process-holder"), function(i, el){
					setTimeout(function(){
						jQuery(el).slideDown("fast");
					}, 100 + (i*100));
				});
				jQuery(".home-process-progress-bar").animate({
					width: '680px'
				}, 800);
				animated++;
			}, 50);
		}
	}
});
jQuery(document).ready(function(){
	var windowWidth = jQuery(window).width();
	if (jQuery("#home-process-wrap").length > 0 && windowWidth > 1024) {
		jQuery(".home-process-holder").hide();
		jQuery(".home-process-progress-bar").css('width','0px');
	}
});
function checkvisible(elm) {
    var vpH = jQuery(window).height(), // Viewport Height
        st = jQuery(window).scrollTop(), // Scroll Top
        y = jQuery(elm).offset().top;
    return ((y + 200) < (vpH + st));
}

// FAQ functions
jQuery(document).ready(function(){
	if (jQuery("#node-faq").length > 0) {
		jQuery(".fieldset-legend h2").click(function(){
			jQuery(this).toggleClass("up-arrow");
		});
	}
});

// CONTACT functions

// Gmaps functions
function initialize() {
	// 39.901737,-83.07686 - map settings
	var myPlace = new google.maps.LatLng(40.10467,-83.01824);
	// 39.899794,-83.077887  - the address
	var myCenter = new google.maps.LatLng(40.10297,-83.01824);
	var mapProp = {
		center:myPlace,
		zoom:15,
		mapTypeId:google.maps.MapTypeId.ROADMAP,
    scrollwheel: false,
    navigationControl: false,
    mapTypeControl: false,
    scaleControl: false,
    draggable: false
	};
	var map=new google.maps.Map(document.getElementById("map_canvas"),mapProp);
	var marker=new google.maps.Marker({
		position:myCenter,
	});
	marker.setMap(map);
	var iw = new google.maps.InfoWindow({
		content: "<div id='window'><span class='infoLine'>Directions Counseling Group</span><span class='infoLine'>6797 N High St</span><span class='infoLine'>Columbus OH 43085</span></div>",
		maxWidth: 280,
	});
//	iw.open(map, marker);
	google.maps.event.addListener(marker, "click", function (e) { iw.open(map, marker); });
	google.maps.event.addDomListener(window, "resize", function() {
	 var center = map.getCenter();
	 google.maps.event.trigger(map, "resize");
	 map.setCenter(center); 
	});
}
jQuery(document).ready(function(){
	if (jQuery("#map_canvas").length > 0) {
		initialize();
	}
});
function ref() { 
	google.maps.event.trigger(map, 'resize');
}
// ASSESSMENTS functions
jQuery(document).ready(function(){
if (jQuery(".view-all-assessments").length > 0 || jQuery("#node-66").length > 0 || jQuery("#node-103").length > 0 || jQuery("#user_user_form_group_personal_info").length > 0 || jQuery("#user_user_full_group_personal_info").length > 0 || jQuery("#content.full-width").length > 0) {
	jQuery('head').append('<link rel="stylesheet" type="text/css" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">');
}
	if (jQuery("#content.full-width").length > 0) {
		var progress_icon = jQuery("<i>");
		if (jQuery(".bar-1").hasClass("step-complete")) {
			jQuery(progress_icon).addClass("fa").addClass("fa-check");
			jQuery(".bar-1").append(progress_icon);
		}
		else {
			jQuery(progress_icon).addClass("fa").addClass("fa-times");
			jQuery(".bar-1").append(progress_icon);
		}
		progress_icon = jQuery("<i>");
		if (jQuery(".bar-2").hasClass("step-complete")) {
			jQuery(progress_icon).addClass("fa").addClass("fa-check");
			jQuery(".bar-2").append(progress_icon);
		}
		else {
			jQuery(progress_icon).addClass("fa").addClass("fa-times");
			jQuery(".bar-2").append(progress_icon);
		}
		progress_icon = jQuery("<i>");
		if (jQuery(".bar-3").hasClass("step-complete")) {
			jQuery(progress_icon).addClass("fa").addClass("fa-check");
			jQuery(".bar-3").append(progress_icon);
		}
		else {
			jQuery(progress_icon).addClass("fa").addClass("fa-times");
			jQuery(".bar-3").append(progress_icon);
		}
		progress_icon = jQuery("<i>");
		if (jQuery(".bar-4").hasClass("step-complete")) {
			jQuery(progress_icon).addClass("fa").addClass("fa-check");
			jQuery(".bar-4").append(progress_icon);
		}
		else {
			jQuery(progress_icon).addClass("fa").addClass("fa-times");
			jQuery(".bar-4").append(progress_icon);
		}
		progress_icon = jQuery("<i>");
	}
});
// STAFF functions
if (jQuery("#node-103").length > 0) {
	jQuery(document).ready(function(){
		jQuery(".light-grey-wrap h3").click(function(){
			jQuery(this).parent().find("p").slideToggle("150");
		});
	});
}

// GET STARTED functions
jQuery(document).ready(function(){
if (jQuery("#user_user_form_group_personal_info").length > 0) {
		var personal_icon = jQuery("<i>");
		jQuery(personal_icon).addClass("fa").addClass("fa-user").addClass("fa-2");
		jQuery("#user_user_form_group_personal_info").find("h3").first().prepend(personal_icon);
		var login_icon = jQuery("<i>");
		jQuery(login_icon).addClass("fa").addClass("fa-lock").addClass("fa-2");
		jQuery("#user_user_form_group_login").find("h3").first().prepend(login_icon);
		var rush_icon = jQuery("<i>");
		jQuery(rush_icon).addClass("fa").addClass("fa-rocket").addClass("fa-2");
		jQuery("#user_user_form_group_rush_service").find("h3").first().prepend(rush_icon);
		var terms_icon = jQuery("<i>");
		jQuery(terms_icon).addClass("fa").addClass("fa-info").addClass("fa-2");
		jQuery("#edit-terms-of-use").find("legend").first().prepend(terms_icon);
}
});

// User Profile Page functions
if (jQuery("#user-user-form-group-profile").length > 0) {
	jQuery(document).ready(function(){
		var personal_icon = jQuery("<i>");
		jQuery(personal_icon).addClass("fa").addClass("fa-user").addClass("fa-2");
		jQuery("#user-user-form-group-profile").find("h3").first().prepend(personal_icon);
  });
}

// ------------------------------------------------------------
// Quick Tabs deep linking work around
// ------------------------------------------------------------
jQuery(".quicktabs_tabs a").each(function(){
  // Unbind the quick tabs action
  jQuery(this).unbind("click");
 
  // Refresh page whenever the tab is clicked
  jQuery(this).click(function(){
    window.location.href = jQuery(this).attr("href");
  });
});